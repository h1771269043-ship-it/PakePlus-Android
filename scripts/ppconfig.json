{"name":"bycj","url":"https://www.shushubuyue.com","showName":"不约插件","appid":"com.bycj.app","icon":"","iconRound":true,"state":true,"single":true,"injectJq":true,"tauriApi":false,"devbug":false,"version":"1.0.1","preview":"Android","platform":["1-1"],"width":2400,"height":1080,"desc":"","jsFile":[],"filterCss":"","customJs":"// ==UserScript==\n// @name         叔叔不约只配女\n// @namespace    yeyu\n// @version      0.7\n// @description  叔叔不约只配女，你懂我的意思吧\n// @author\n// @match        *://*.shushubuyue.net/*\n// @match        *://*.shushubuyue.com/*\n// @icon         https://www.google.com/s2/favicons?sz=64&domain=shushubuyue.net\n// @license      MIT\n// @downloadURL https://update.greasyfork.org/scripts/456928/%E5%8F%94%E5%8F%94%E4%B8%8D%E7%BA%A6%E5%8F%AA%E9%85%8D%E5%A5%B3.user.js\n// @updateURL https://update.greasyfork.org/scripts/456928/%E5%8F%94%E5%8F%94%E4%B8%8D%E7%BA%A6%E5%8F%AA%E9%85%8D%E5%A5%B3.meta.js\n// ==/UserScript==\n\n(function () {\n    'use strict';\n\n    // 默认配置\n    let config = {\n        enabled: true,\n        contactInfo: '这是我的联系方式',\n        greeting1: '你好啊',\n        greeting2: '很高兴认识你'\n    };\n\n    // 尝试从本地存储加载配置\n    try {\n        const savedConfig = localStorage.getItem('shushubuyue_config');\n        if (savedConfig) {\n            config = {...config, ...JSON.parse(savedConfig)};\n        }\n    } catch (e) {\n        console.log('加载配置失败', e);\n    }\n\n    // 保存配置到本地存储\n    function saveConfig() {\n        try {\n            localStorage.setItem('shushubuyue_config', JSON.stringify(config));\n        } catch (e) {\n            console.log('保存配置失败', e);\n        }\n    }\n\n    // 创建悬浮按钮\n    function createFloatingButtons() {\n        // 创建三角形控制按钮\n        const toggleBtn = document.createElement('div');\n        toggleBtn.id = 'shushubuyue-toggle';\n        toggleBtn.style.position = 'fixed';\n        toggleBtn.style.top = '10px';\n        toggleBtn.style.right = '10px';\n        toggleBtn.style.width = '0';\n        toggleBtn.style.height = '0';\n        // 修改为朝右的三角形\n        toggleBtn.style.borderTop = '10px solid transparent';  // 调整为原来的20%\n        toggleBtn.style.borderBottom = '10px solid transparent';  // 调整为原来的20%\n        toggleBtn.style.borderLeft = '20px solid rgba(255, 255, 255, 0.5)';  // 调整为原来的20%\n        toggleBtn.style.borderRight = 'none';\n        toggleBtn.style.cursor = 'pointer';\n        toggleBtn.style.zIndex = '2147483647';\n        toggleBtn.title = '点击开关脚本，长按配置';\n\n        // 创建发送联系方式按钮\n        const contactBtn = document.createElement('div');\n        contactBtn.id = 'shushubuyue-contact';\n        contactBtn.textContent = '发送联系方式';\n        contactBtn.style.position = 'fixed';\n        contactBtn.style.top = '70px';\n        contactBtn.style.right = '20px';\n        contactBtn.style.padding = '8px 12px';\n        contactBtn.style.backgroundColor = '#4CAF50';\n        contactBtn.style.color = 'white';\n        contactBtn.style.borderRadius = '4px';\n        contactBtn.style.cursor = 'pointer';\n        contactBtn.style.zIndex = '9999';\n        contactBtn.style.fontSize = '14px';\n        contactBtn.style.display = config.enabled ? 'block' : 'none';\n\n        // 添加按钮到页面\n        document.body.appendChild(toggleBtn);\n        document.body.appendChild(contactBtn);\n\n        // 按钮事件处理\n        let longPressTimer;\n        const longPressDuration = 1000; // 长按1秒触发配置\n\n        toggleBtn.addEventListener('mousedown', function() {\n            longPressTimer = setTimeout(showConfigPanel, longPressDuration);\n        });\n\n        toggleBtn.addEventListener('mouseup', function() {\n            clearTimeout(longPressTimer);\n        });\n\n        toggleBtn.addEventListener('mouseleave', function() {\n            clearTimeout(longPressTimer);\n        });\n\n        toggleBtn.addEventListener('click', function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            clearTimeout(longPressTimer);\n            toggleScript();\n        });\n\n        contactBtn.addEventListener('click', function() {\n            sendContactInfo();\n        });\n    }\n\n    // 开关脚本\n    function toggleScript() {\n        config.enabled = !config.enabled;\n        saveConfig();\n\n        // 更新按钮显示\n        const contactBtn = document.getElementById('shushubuyue-contact');\n        if (contactBtn) {\n            contactBtn.style.display = config.enabled ? 'block' : 'none';\n        }\n\n        // 更新三角形按钮颜色\n        const toggleBtn = document.getElementById('shushubuyue-toggle');\n        if (toggleBtn) {\n            toggleBtn.style.borderLeftColor = config.enabled ?\n                'rgba(255, 255, 255, 0.5)' : 'rgba(255, 0, 0, 0.5)';\n        }\n\n        // 如果关闭脚本，停止所有自动操作\n        if (!config.enabled) {\n            firstAuto = true;\n        }\n    }\n\n    // 发送联系方式（分开发送，一次三位）\n    function sendContactInfo() {\n        if (!config.enabled) return;\n\n        try {\n            const msgInput = document.querySelector(\"#msgInput\");\n            const sendButton = document.querySelector(\".button-link.msg-send\");\n\n            if (!msgInput || !sendButton) return;\n\n            const contactText = config.contactInfo;\n            const chunkSize = 3; // 每次发送3个字符\n\n            // 分段发送联系方式\n            for (let i = 0; i < contactText.length; i += chunkSize) {\n                const chunk = contactText.substring(i, i + chunkSize);\n\n                // 使用setTimeout延迟发送，确保按顺序发送\n                setTimeout(() => {\n                    msgInput.value = chunk;\n                    msgInput.dispatchEvent(new Event('input'));\n                    msgInput.dispatchEvent(new Event('change'));\n                    sendButton.click();\n                }, i * 500); // 每段间隔500毫秒\n            }\n        } catch (e) {\n            console.log('发送联系方式失败', e);\n        }\n    }\n\n    // 显示配置面板\n    function showConfigPanel() {\n        // 创建遮罩层\n        const overlay = document.createElement('div');\n        overlay.id = 'shushubuyue-config-overlay';\n        overlay.style.position = 'fixed';\n        overlay.style.top = '0';\n        overlay.style.left = '0';\n        overlay.style.width = '100%';\n        overlay.style.height = '100%';\n        overlay.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';\n        overlay.style.zIndex = '10000';\n        overlay.style.display = 'flex';\n        overlay.style.justifyContent = 'center';\n        overlay.style.alignItems = 'center';\n\n        // 创建配置面板\n        const panel = document.createElement('div');\n        panel.style.backgroundColor = '#222';\n        panel.style.padding = '20px';\n        panel.style.borderRadius = '8px';\n        panel.style.width = '300px';\n        panel.style.color = 'white';\n\n        // 面板标题\n        const title = document.createElement('h3');\n        title.textContent = '叔叔不约配置';\n        title.style.marginTop = '0';\n        title.style.textAlign = 'center';\n        panel.appendChild(title);\n\n        // 联系方式输入框\n        const contactLabel = document.createElement('label');\n        contactLabel.textContent = '联系方式:';\n        contactLabel.style.display = 'block';\n        contactLabel.style.marginBottom = '5px';\n        panel.appendChild(contactLabel);\n\n        const contactInput = document.createElement('input');\n        contactInput.type = 'text';\n        contactInput.value = config.contactInfo;\n        contactInput.style.width = '100%';\n        contactInput.style.padding = '8px';\n        contactInput.style.marginBottom = '15px';\n        contactInput.style.boxSizing = 'border-box';\n        contactInput.style.color = 'black';\n        contactInput.style.backgroundColor = 'white';\n        panel.appendChild(contactInput);\n\n        // 打招呼语句1输入框\n        const greeting1Label = document.createElement('label');\n        greeting1Label.textContent = '打招呼语句1:';\n        greeting1Label.style.display = 'block';\n        greeting1Label.style.marginBottom = '5px';\n        panel.appendChild(greeting1Label);\n\n        const greeting1Input = document.createElement('input');\n        greeting1Input.type = 'text';\n        greeting1Input.value = config.greeting1;\n        greeting1Input.style.width = '100%';\n        greeting1Input.style.padding = '8px';\n        greeting1Input.style.marginBottom = '15px';\n        greeting1Input.style.boxSizing = 'border-box';\n        greeting1Input.style.color = 'black';\n        greeting1Input.style.backgroundColor = 'white';\n        panel.appendChild(greeting1Input);\n\n        // 打招呼语句2输入框\n        const greeting2Label = document.createElement('label');\n        greeting2Label.textContent = '打招呼语句2:';\n        greeting2Label.style.display = 'block';\n        greeting2Label.style.marginBottom = '5px';\n        panel.appendChild(greeting2Label);\n\n        const greeting2Input = document.createElement('input');\n        greeting2Input.type = 'text';\n        greeting2Input.value = config.greeting2;\n        greeting2Input.style.width = '100%';\n        greeting2Input.style.padding = '8px';\n        greeting2Input.style.marginBottom = '20px';\n        greeting2Input.style.boxSizing = 'border-box';\n        greeting2Input.style.color = 'black';\n        greeting2Input.style.backgroundColor = 'white';\n        panel.appendChild(greeting2Input);\n\n        // 保存按钮\n        const saveBtn = document.createElement('button');\n        saveBtn.textContent = '保存配置';\n        saveBtn.style.width = '100%';\n        saveBtn.style.padding = '10px';\n        saveBtn.style.backgroundColor = '#4CAF50';\n        saveBtn.style.color = 'white';\n        saveBtn.style.border = 'none';\n        saveBtn.style.borderRadius = '4px';\n        saveBtn.style.cursor = 'pointer';\n        saveBtn.onclick = function() {\n            config.contactInfo = contactInput.value;\n            config.greeting1 = greeting1Input.value;\n            config.greeting2 = greeting2Input.value;\n            saveConfig();\n            document.body.removeChild(overlay);\n        };\n        panel.appendChild(saveBtn);\n\n        // 关闭按钮\n        const closeBtn = document.createElement('button');\n        closeBtn.textContent = '关闭';\n        closeBtn.style.width = '100%';\n        closeBtn.style.padding = '10px';\n        closeBtn.style.backgroundColor = '#f44336';\n        closeBtn.style.color = 'white';\n        closeBtn.style.border = 'none';\n        closeBtn.style.borderRadius = '4px';\n        closeBtn.style.cursor = 'pointer';\n        closeBtn.style.marginTop = '10px';\n        closeBtn.onclick = function() {\n            document.body.removeChild(overlay);\n        };\n        panel.appendChild(closeBtn);\n\n        overlay.appendChild(panel);\n        document.body.appendChild(overlay);\n\n        // 点击遮罩层关闭\n        overlay.addEventListener('click', function(e) {\n            if (e.target === overlay) {\n                document.body.removeChild(overlay);\n            }\n        });\n    }\n\n    // 随机选择问候语（50%概率选择第一条，50%概率选择第二条）\n    function getRandomGreeting() {\n        return Math.random() < 0.5 ? config.greeting1 : config.greeting2;\n    }\n\n    // 原脚本功能\n    let firstAuto = true;\n\n    function leave() {\n        var leftButton = document.querySelector(\"a.button-link.chat-control\");\n        if (leftButton) leftButton.click()\n        var leftSecondButton = document.querySelector(\n            \"span.actions-modal-button.actions-modal-button-bold.color-danger\")\n        if (leftSecondButton) leftSecondButton.click()\n\n        var restartButton = document.querySelector(\"span.chat-control\")\n        if (restartButton && restartButton.innerText) {\n            if (typeof restartButton.innerText == \"string\" && restartButton.innerText == \"离开\") {\n                restartButton.click()\n                setTimeout(function () {\n                    restartButton.click()\n                }, 500)\n            } else if (typeof restartButton.innerText == \"string\" && restartButton.innerText == \"重新开始\") {\n                restartButton.click()\n            } else {\n                console.log(\"error restartButton\")\n            }\n        }\n    }\n\n    function init() {\n        createFloatingButtons();\n\n        setInterval(() => {\n            if (!config.enabled) return;\n\n            var tab = document.querySelector(\"#partnerInfoText\")\n            if (tab) var tabText = tab.innerText\n            if (tabText && typeof tabText == 'string' && tabText.indexOf(\"女生\") != -1) {\n                //女生\n\n                var restartButton = document.querySelector(\"span.chat-control\")\n                if (restartButton && restartButton.innerText) {\n                    if (typeof restartButton.innerText == \"string\" && restartButton.innerText == \"离开\") {\n                        restartButton.click()\n                        setTimeout(function () {\n                            restartButton.click()\n                        }, 500)\n                    } else if (typeof restartButton.innerText == \"string\" && restartButton.innerText ==\n                        \"重新开始\") {\n                        restartButton.click()\n                    } else {\n                        //console.log(\"error restartButton\")\n                    }\n                }\n\n                if (firstAuto) {\n                    firstAuto = false\n\n                    setTimeout((ev) => {\n                        var msgInput = document.querySelector(\"#msgInput\")\n                        // 随机选择问候语\n                        msgInput.value = getRandomGreeting();\n                        msgInput.dispatchEvent(new Event('input'))\n                        msgInput.dispatchEvent(new Event('change'))\n                        document.querySelector(\".button-link.msg-send\").click()\n                    }, 1000)\n                }\n            }\n\n            if (tabText && typeof tabText == 'string' && tabText.indexOf(\"男生\") != -1) {\n                firstAuto = true\n                //男生\n                leave()\n            }\n        }, 1000)\n    }\n\n    setTimeout(init, 5000)\n})();","isHtml":false,"htmlPath":"","htmlFiles":[],"more":{"windows":{"label":"","title":"不约插件","url":"https://www.shushubuyue.com","userAgent":"Mozilla/5.0 (Linux; Android 14; Pixel 6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Mobile Safari/537.36","width":2400,"height":1080,"theme":null,"resizable":true,"fullscreen":false,"maximized":false,"minWidth":400,"minHeight":300,"maxWidth":1920,"maxHeight":1080,"decorations":true,"transparent":false,"titleBarStyle":"Visible","visible":true,"focus":true,"closable":true,"minimizable":true,"maximizable":true,"alwaysOnTop":false,"alwaysOnBottom":false,"center":false,"skipTaskbar":false,"tabbingIdentifier":null,"parent":null,"dragDropEnabled":true,"browserExtensionsEnabled":false,"devtools":true,"contentProtected":false,"hiddenTitle":false,"incognito":false,"proxyUrl":null,"useHttpsScheme":false,"zoomHotkeysEnabled":false,"acceptFirstMouse":false,"create":false}},"phone":{"safeArea":{"top":0,"bottom":0,"left":0,"right":0},"header":{"show":false,"title":"","backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","loading":false,"toolBar":false,"toolBarBackgroundColor":"","toolBarColor":"","toolBarFontSize":16,"toolBarFontWeight":"bold"},"siderMenu":{"show":false,"width":0,"backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","title":"","titleColor":"","titleFontSize":16,"titleFontWeight":"bold"},"tabBar":{"show":false,"backgroundColor":"","color":"","activeColor":"","fontSize":16,"fontWeight":"bold","tabBarItem":[]},"webview":{"userAgent":"","javaScriptEnabled":true,"domStorageEnabled":true,"allowFileAccess":true,"loadWithOverviewMode":true,"setSupportZoom":true,"clearCache":true}},"ios":{"name":"bycj","showName":"不约插件","version":"1.0.1","webUrl":"https://www.shushubuyue.com","id":"com.bycj.app.ios","icon":"./app-icon.png","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","isHtml":false,"debug":false},"android":{"name":"bycj","showName":"不约插件","version":"1.0.1","webUrl":"https://www.shushubuyue.com","id":"com.bycj.app.android","icon":"./app-icon.png","input":"./app-icon.png","output":"./res","rounded":true,"copyTo":"./app/src/main/res","androidResDir":"./app/src/main/res","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","isHtml":false,"debug":false},"desktop":{"name":"bycj","showName":"不约插件","version":"1.0.1","id":"com.bycj.app.desktop","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途，否则后果自负）","webUrl":"https://www.shushubuyue.com","iconPath":"../app-icon.png","inputPath":"../app-icon.png","tempPath":"./processed-image.png","icnsPath":"../src-tauri/icons/icon.icns","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途，否则后果自负）","isHtml":false,"single":true,"state":true,"injectJq":false,"tauriApi":false,"buildMethod":"local","debug":false}}